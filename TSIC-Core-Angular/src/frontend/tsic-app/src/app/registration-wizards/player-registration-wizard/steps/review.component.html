<div class="card shadow border-0 card-rounded">
    <div class="card-header card-header-subtle border-0 py-3">
        <h5 class="mb-0 fw-semibold">Review & Submit</h5>
    </div>
    <div class="card-body">
        <p class="text-secondary mb-3">Summary of selections will show here. Payment step comes next.</p>
        <div class="mb-3">
            <div class="fw-semibold mb-2">Player Registrations</div>
            <ul class="list-unstyled mb-0">
                <li *ngFor="let player of state.selectedPlayers(); trackBy: trackPlayer">
                    <span class="fw-semibold">{{ player.name }}</span>
                    <span class="ms-2 text-secondary">registered for</span>
                    <span class="ms-1">
                        <ng-container *ngIf="getTeamsForPlayer(player.userId).length > 0; else noTeam">
                            {{ getTeamsForPlayer(player.userId).join(', ') }}
                        </ng-container>
                        <ng-template #noTeam>
                            <span class="text-danger">No team selected</span>
                        </ng-template>
                    </span>
                </li>
            </ul>
        </div>
        <div *ngIf="state.waiverDefinitions().length > 0" class="mb-3 p-3 border rounded bg-body-tertiary">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="fw-semibold">Waivers</div>
                <span class="badge"
                    [ngClass]="state.allRequiredWaiversAccepted() ? 'bg-success' : 'bg-warning text-dark'">
                    {{ state.allRequiredWaiversAccepted() ? 'All required accepted' : 'Pending acceptance' }}
                </span>
            </div>
            <ul class="small mb-0">
                @for (w of state.waiverDefinitions(); track w.id) {
                <li>
                    <i class="bi"
                        [ngClass]="state.isWaiverAccepted(w.id) ? 'bi-check-circle text-success' : 'bi-exclamation-circle text-warning' "></i>
                    <span class="ms-1">{{ w.title }}</span>
                </li>
                }
            </ul>
            <!-- Signature line removed: waivers now use checkbox acceptance only -->
        </div>
        <div class="rw-bottom-nav d-flex gap-2">
            <button type="button" class="btn btn-outline-secondary" (click)="back.emit()">Back</button>
            <button type="button" class="btn btn-primary" (click)="next.emit()">Proceed to Payment</button>
        </div>
    </div>
</div>