<main class="container py-4" aria-labelledby="rw-title">
    <div class="row justify-content-center">
        <div class="col-lg-9 col-xl-8">
            <div class="card shadow-lg border-0 card-rounded mb-4">
                <div class="card-header gradient-header text-center py-4 border-0">
                    <h2 id="rw-title" class="mb-0 fw-bold">Player Registration</h2>
                    <p class="mb-0 mt-2 opacity-75 small">Step {{ currentIndex() + 1 }} of {{ steps().length }}</p>
                </div>
            </div>

            <div class="rw-sticky-header mb-4">
                <progress class="w-100 mb-2" [value]="progressPercent()" max="100">{{ progressPercent() }}%</progress>
                <nav class="rw-steps mb-3" aria-label="Player registration steps">
                    <ol class="rw-steps-list">
                        @for (s of steps(); track s; let i = $index) {
                        <li class="rw-step" [class.active]="i === currentIndex()" [class.completed]="i < currentIndex()"
                            [attr.aria-current]="i === currentIndex() ? 'step' : null">
                            <span class="rw-step-index">{{ i + 1 }}</span>
                            <span class="rw-step-label">{{ stepLabels[s] }}</span>
                        </li>
                        }
                    </ol>
                </nav>

                <div class="rw-toolbar d-flex justify-content-between align-items-center">
                    <button type="button"
                        class="btn btn-sm btn-outline-secondary d-inline-flex align-items-center gap-1" (click)="back()"
                        [disabled]="currentIndex() === 0" aria-label="Go back to previous step">
                        <i class="bi bi-arrow-left"></i>
                        <span>Back</span>
                    </button>
                    <div class="d-inline-flex align-items-center gap-2">
                        <span class="text-secondary small">Current:</span>
                        <span
                            class="badge rounded-pill bg-primary-subtle text-primary border border-primary-subtle px-3 py-2">
                            {{ stepLabels[currentStepId()] }}
                        </span>
                    </div>
                </div>
            </div>

            @switch (currentStepId()) {
            @case ('start') {
            <app-rw-start-choice (selected)="onStartChoice($event)" />
            }
            @case ('family-check') {
            <app-rw-family-check (next)="next()" />
            }
            @case ('edit-lookup') {
            <app-rw-edit-lookup (back)="back()" (next)="next()" />
            }
            @case ('players') {
            <app-rw-player-selection (next)="next()" />
            }
            @case ('constraint') {
            <app-rw-constraint-selection (back)="back()" (next)="next()" />
            }
            @case ('teams') {
            <app-rw-team-selection (back)="back()" (next)="next()" />
            }
            @case ('forms') {
            <app-rw-player-forms (back)="back()" (next)="next()" />
            }
            @case ('review') {
            <app-rw-review (back)="back()" (next)="next()" />
            }
            @case ('payment') {
            <app-rw-payment (back)="back()" (submitted)="next()" />
            }
            }
        </div>
    </div>
</main>