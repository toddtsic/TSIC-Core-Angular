<main class="container py-4" aria-labelledby="rw-title" [wizardTheme]="'player'">
    <div class="row justify-content-center">
        <div class="col-lg-9 col-xl-8">
            <div class="card shadow-lg border-0 card-rounded mb-4">
                <div class="card-header gradient-header text-center py-4 border-0">
                    <h2 id="rw-title" class="mb-0 fw-bold">Player Registration</h2>
                    <div class="mt-2">
                        <span
                            class="badge rounded-pill text-bg-light text-primary-emphasis px-3 py-2 fw-semibold text-nowrap shadow-sm"
                            aria-live="polite">
                            Step {{ currentIndex() + 1 }} of {{ steps().length }}
                        </span>
                    </div>
                </div>
            </div>

            <div class="rw-sticky-header mb-4">
                <progress class="w-100 mb-2 rw-progress" [value]="progressPercent()" max="100">{{ progressPercent()
                    }}%</progress>
                <nav class="rw-steps mb-3" aria-label="Current step">
                    <ol class="rw-steps-list justify-content-center">
                        <li class="rw-step active" aria-current="step">
                            <span class="rw-step-index">{{ currentIndex() + 1 }}</span>
                            <span class="rw-step-label">{{ stepLabels[steps()[currentIndex()]] }}</span>
                        </li>
                    </ol>
                </nav>

                <div class="rw-toolbar">
                    <div class="d-flex align-items-center justify-content-between flex-nowrap gap-2">
                        @if (familyLastName()) {
                        <div class="text-truncate me-2" title="Family account">
                            <span
                                class="badge bg-warning-subtle text-warning-emphasis border border-warning-subtle px-2 py-1 small">
                                {{ familyLastName() }} Family
                            </span>
                        </div>
                        }
                        <div class="btn-group btn-group-sm">
                            <button type="button"
                                class="btn btn-outline-secondary d-inline-flex align-items-center gap-1"
                                (click)="back()" [disabled]="currentIndex() === 0"
                                aria-label="Go back to previous step">
                                <i class="bi bi-arrow-left"></i>
                                <span>Back</span>
                            </button>
                            @if (showContinueButton()) {
                            <button type="button" class="btn btn-primary" (click)="onContinue()"
                                [disabled]="!canContinue()">
                                {{ continueLabel() }}
                            </button>
                            }
                        </div>
                    </div>
                </div>
            </div>

            @switch (currentStepId()) {
            @case ('family-check') {
            <app-rw-family-check (next)="next()" />
            }
            @case ('players') {
            <app-rw-player-selection (next)="next()" />
            }
            @case ('eligibility') {
            <app-rw-eligibility-selection (back)="back()" (next)="next()" />
            }
            @case ('teams') {
            <app-rw-team-selection (back)="back()" (next)="next()" [multiSelect]="isMultiTeamMode()" />
            }
            @case ('forms') {
            <app-rw-player-forms (back)="back()" (next)="next()" />
            }
            @case ('waivers') {
            <app-rw-waivers (back)="back()" (next)="next()" />
            }
            @case ('review') {
            <app-rw-review (back)="back()" (next)="proceedToPayment()" />
            }
            @case ('payment') {
            <app-rw-payment (back)="back()" (submitted)="next()" />
            }
            @default {
            <div class="alert alert-warning" role="note">
                Unknown step "{{ currentStepId() }}". Please go back and try again.
            </div>
            }
            }
        </div>
    </div>

</main>