<!-- Page header -->
<div class="d-flex flex-column flex-md-row align-items-md-center justify-content-md-between mb-4 gap-2">
	<div>
		<h2 class="mb-0">Job Configuration</h2>
		@if (config(); as c) {
			<small class="text-body-secondary">{{ c.jobPath }}</small>
		}
	</div>
	<div class="d-flex gap-2">
		<button class="btn btn-outline-secondary btn-sm" (click)="reload()" [disabled]="isLoading()">
			<i class="bi bi-arrow-clockwise me-1"></i>Reload
		</button>
	</div>
</div>

<!-- Tab navigation -->
<div class="editor-tabs">
	@for (tab of tabs; track tab.id) {
		<button class="editor-tab" [class.active]="activeTab() === tab.id" (click)="activeTab.set(tab.id)">
			<i class="bi {{ tab.icon }} me-1"></i>{{ tab.label }}
		</button>
	}
</div>

<!-- Error alert -->
@if (errorMessage()) {
	<div class="alert alert-danger d-flex align-items-center" role="alert">
		<i class="bi bi-exclamation-triangle-fill me-2"></i>
		{{ errorMessage() }}
		<button type="button" class="btn-close ms-auto" (click)="errorMessage.set(null)"></button>
	</div>
}

<!-- Loading state -->
@if (isLoading()) {
	<div class="text-center py-5">
		<div class="spinner-border text-primary" role="status">
			<span class="visually-hidden">Loading...</span>
		</div>
		<p class="mt-2 text-body-secondary">Loading job configuration...</p>
	</div>
}

<!-- ══════════════════════════════════════ -->
<!-- TAB 1: General                        -->
<!-- ══════════════════════════════════════ -->
@if (!isLoading() && config(); as c) {
	@if (activeTab() === 'general') {
		<div class="config-section">
			<h5 class="section-heading">Identity</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Job Name</label>
					<input type="text" class="form-control" [value]="c.jobName ?? ''"
						(input)="updateFieldFromEvent('jobName', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Display Name</label>
					<input type="text" class="form-control" [value]="c.displayName ?? ''"
						(input)="updateFieldFromEvent('displayName', $event)">
				</div>
				<div class="form-group span-2">
					<label class="form-label">Description</label>
					<textarea class="form-control" rows="3" [value]="c.jobDescription ?? ''"
						(input)="updateFieldFromEvent('jobDescription', $event)"></textarea>
				</div>
				<div class="form-group">
					<label class="form-label">Tagline</label>
					<input type="text" class="form-control" [value]="c.jobTagline ?? ''"
						(input)="updateFieldFromEvent('jobTagline', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Job Code</label>
					<input type="text" class="form-control" [value]="c.jobCode ?? ''"
						(input)="updateFieldFromEvent('jobCode', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Year</label>
					<input type="text" class="form-control" [value]="c.year ?? ''"
						(input)="updateFieldFromEvent('year', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Season</label>
					<input type="text" class="form-control" [value]="c.season ?? ''"
						(input)="updateFieldFromEvent('season', $event)">
				</div>
			</div>

			<h5 class="section-heading">Classification</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Job Type</label>
					<select class="form-select" [value]="c.jobTypeId"
						(change)="updateNumber('jobTypeId', $event)">
						@if (lookups(); as lk) {
							@for (jt of lk.jobTypes; track jt.jobTypeId) {
								<option [value]="jt.jobTypeId">{{ jt.jobTypeName }}</option>
							}
						}
					</select>
				</div>
				<div class="form-group">
					<label class="form-label">Sport</label>
					<select class="form-select" [value]="c.sportId"
						(change)="updateFieldFromEvent('sportId', $event)">
						@if (lookups(); as lk) {
							@for (sp of lk.sports; track sp.sportId) {
								<option [value]="sp.sportId">{{ sp.sportName }}</option>
							}
						}
					</select>
				</div>
				<div class="form-group">
					<label class="form-label">Billing Type</label>
					<select class="form-select" [value]="c.billingTypeId"
						(change)="updateNumber('billingTypeId', $event)">
						@if (lookups(); as lk) {
							@for (bt of lk.billingTypes; track bt.billingTypeId) {
								<option [value]="bt.billingTypeId">{{ bt.billingTypeName }}</option>
							}
						}
					</select>
				</div>
			</div>

			<h5 class="section-heading">Dates</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Admin Expiry</label>
					<input type="date" class="form-control" [value]="toDateInputValue(c.expiryAdmin)"
						(input)="updateFieldFromEvent('expiryAdmin', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">User Expiry</label>
					<input type="date" class="form-control" [value]="toDateInputValue(c.expiryUsers)"
						(input)="updateFieldFromEvent('expiryUsers', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Event Start Date</label>
					<input type="date" class="form-control" [value]="toDateInputValue(c.eventStartDate)"
						(input)="updateFieldFromEvent('eventStartDate', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Event End Date</label>
					<input type="date" class="form-control" [value]="toDateInputValue(c.eventEndDate)"
						(input)="updateFieldFromEvent('eventEndDate', $event)">
				</div>
			</div>

			<h5 class="section-heading">Display & SEO</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Mobile Job Name</label>
					<input type="text" class="form-control" [value]="c.mobileJobName ?? ''"
						(input)="updateFieldFromEvent('mobileJobName', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">QBP Job Name</label>
					<input type="text" class="form-control" [value]="c.jobNameQbp ?? ''"
						(input)="updateFieldFromEvent('jobNameQbp', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Mom Label</label>
					<input type="text" class="form-control" [value]="c.momLabel ?? ''"
						(input)="updateFieldFromEvent('momLabel', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Dad Label</label>
					<input type="text" class="form-control" [value]="c.dadLabel ?? ''"
						(input)="updateFieldFromEvent('dadLabel', $event)">
				</div>
				<div class="form-group span-2">
					<label class="form-label">SEO Keywords</label>
					<input type="text" class="form-control" [value]="c.searchenginKeywords ?? ''"
						(input)="updateFieldFromEvent('searchenginKeywords', $event)">
				</div>
				<div class="form-group span-2">
					<label class="form-label">SEO Description</label>
					<textarea class="form-control" rows="2" [value]="c.searchengineDescription ?? ''"
						(input)="updateFieldFromEvent('searchengineDescription', $event)"></textarea>
				</div>
			</div>

			<h5 class="section-heading">Banner & Status</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Banner File</label>
					<input type="text" class="form-control" [value]="c.bannerFile ?? ''"
						(input)="updateFieldFromEvent('bannerFile', $event)">
				</div>
				<div class="form-check-group">
					<label class="form-check">
						<input type="checkbox" class="form-check-input" [checked]="c.bBannerIsCustom"
							(change)="updateCheckbox('bBannerIsCustom', $event)">
						<span class="form-check-label">Custom Banner</span>
					</label>
					<label class="form-check">
						<input type="checkbox" class="form-check-input" [checked]="c.bSuspendPublic"
							(change)="updateCheckbox('bSuspendPublic', $event)">
						<span class="form-check-label">Suspend Public Access</span>
					</label>
				</div>
			</div>
		</div>
	}

	<!-- ══════════════════════════════════════ -->
	<!-- TAB 2: Registration                   -->
	<!-- ══════════════════════════════════════ -->
	@if (activeTab() === 'registration') {
		<div class="config-section">
			<h5 class="section-heading">Registration Types</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bRegistrationAllowPlayer"
						(change)="updateCheckbox('bRegistrationAllowPlayer', $event)">
					<span class="form-check-label">Allow Player Registration</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bRegistrationAllowTeam"
						(change)="updateCheckbox('bRegistrationAllowTeam', $event)">
					<span class="form-check-label">Allow Team Registration</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bAllowMobileRegn"
						(change)="updateCheckbox('bAllowMobileRegn', $event)">
					<span class="form-check-label">Allow Mobile Registration</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bUseWaitlists"
						(change)="updateCheckbox('bUseWaitlists', $event)">
					<span class="form-check-label">Use Waitlists</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bRestrictPlayerTeamsToAgerange"
						(change)="updateCheckbox('bRestrictPlayerTeamsToAgerange', $event)">
					<span class="form-check-label">Restrict Player Teams to Age Range</span>
				</label>
			</div>

			<h5 class="section-heading">Insurance</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bOfferPlayerRegsaverInsurance"
						(change)="updateCheckbox('bOfferPlayerRegsaverInsurance', $event)">
					<span class="form-check-label">Offer Player RegSaver Insurance</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bOfferTeamRegsaverInsurance"
						(change)="updateCheckbox('bOfferTeamRegsaverInsurance', $event)">
					<span class="form-check-label">Offer Team RegSaver Insurance</span>
				</label>
			</div>

			<h5 class="section-heading">Multi-Player Discount</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Minimum Players</label>
					<input type="number" class="form-control" [value]="c.playerRegMultiPlayerDiscountMin ?? ''"
						(input)="updateNumber('playerRegMultiPlayerDiscountMin', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Discount Percent</label>
					<input type="number" class="form-control" [value]="c.playerRegMultiPlayerDiscountPercent ?? ''"
						(input)="updateNumber('playerRegMultiPlayerDiscountPercent', $event)">
				</div>
			</div>

			<h5 class="section-heading">Form Names</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Core Regform (Player)</label>
					<input type="text" class="form-control" [value]="c.coreRegformPlayer ?? ''"
						(input)="updateFieldFromEvent('coreRegformPlayer', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Player Form Name</label>
					<input type="text" class="form-control" [value]="c.regformNamePlayer ?? ''"
						(input)="updateFieldFromEvent('regformNamePlayer', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Team Form Name</label>
					<input type="text" class="form-control" [value]="c.regformNameTeam ?? ''"
						(input)="updateFieldFromEvent('regformNameTeam', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Coach Form Name</label>
					<input type="text" class="form-control" [value]="c.regformNameCoach ?? ''"
						(input)="updateFieldFromEvent('regformNameCoach', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Club Rep Form Name</label>
					<input type="text" class="form-control" [value]="c.regformNameClubRep ?? ''"
						(input)="updateFieldFromEvent('regformNameClubRep', $event)">
				</div>
			</div>

			<h5 class="section-heading">Advanced</h5>
			<div class="form-grid">
				<div class="form-group span-2">
					<label class="form-label">Player Profile Metadata (JSON)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.playerProfileMetadataJson ?? ''"
						(input)="updateFieldFromEvent('playerProfileMetadataJson', $event)"></textarea>
				</div>
				<div class="form-group">
					<label class="form-label">US Lax Number Valid Through</label>
					<input type="date" class="form-control"
						[value]="toDateInputValue(c.uslaxNumberValidThroughDate)"
						(input)="updateFieldFromEvent('uslaxNumberValidThroughDate', $event)">
				</div>
			</div>
		</div>
	}

	<!-- ══════════════════════════════════════ -->
	<!-- TAB 3: Payment                        -->
	<!-- ══════════════════════════════════════ -->
	@if (activeTab() === 'payment') {
		<div class="config-section">
			<h5 class="section-heading">Payment Methods</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Payment Methods Allowed Code</label>
					<input type="number" class="form-control" [value]="c.paymentMethodsAllowedCode"
						(input)="updateNumber('paymentMethodsAllowedCode', $event)">
					<small class="form-text text-body-secondary">Bitmask value for allowed payment methods</small>
				</div>
			</div>

			<h5 class="section-heading">Processing Fees</h5>
			<div class="form-grid">
				<div class="form-check-group">
					<label class="form-check">
						<input type="checkbox" class="form-check-input" [checked]="c.bAddProcessingFees"
							(change)="updateCheckbox('bAddProcessingFees', $event)">
						<span class="form-check-label">Add Processing Fees</span>
					</label>
					<label class="form-check">
						<input type="checkbox" class="form-check-input" [checked]="c.bApplyProcessingFeesToTeamDeposit"
							(change)="updateCheckbox('bApplyProcessingFeesToTeamDeposit', $event)">
						<span class="form-check-label">Apply Processing Fees to Team Deposit</span>
					</label>
				</div>
				<div class="form-group">
					<label class="form-label">Processing Fee Percent</label>
					<input type="number" step="0.01" class="form-control"
						[value]="c.processingFeePercent ?? ''"
						(input)="updateNumber('processingFeePercent', $event)">
				</div>
			</div>

			<h5 class="section-heading">Team Payments</h5>
			<div class="form-grid">
				<div class="form-check-group">
					<label class="form-check">
						<input type="checkbox" class="form-check-input" [checked]="c.bTeamsFullPaymentRequired"
							(change)="updateCheckbox('bTeamsFullPaymentRequired', $event)">
						<span class="form-check-label">Teams Full Payment Required</span>
					</label>
				</div>
				<div class="form-group">
					<label class="form-label">Balance Due as Percent</label>
					<input type="text" class="form-control" [value]="c.balancedueaspercent ?? ''"
						(input)="updateFieldFromEvent('balancedueaspercent', $event)">
				</div>
			</div>

			<h5 class="section-heading">Refunds & Credits</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bAllowRefundsInPriorMonths"
						(change)="updateCheckbox('bAllowRefundsInPriorMonths', $event)">
					<span class="form-check-label">Allow Refunds in Prior Months</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bAllowCreditAll"
						(change)="updateCheckbox('bAllowCreditAll', $event)">
					<span class="form-check-label">Allow Credit All</span>
				</label>
			</div>

			<h5 class="section-heading">Mail-In Payment</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Pay To</label>
					<input type="text" class="form-control" [value]="c.payTo ?? ''"
						(input)="updateFieldFromEvent('payTo', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Mail To</label>
					<input type="text" class="form-control" [value]="c.mailTo ?? ''"
						(input)="updateFieldFromEvent('mailTo', $event)">
				</div>
				<div class="form-group span-2">
					<label class="form-label">Mail-In Payment Warning</label>
					<textarea class="form-control" rows="2" [value]="c.mailinPaymentWarning ?? ''"
						(input)="updateFieldFromEvent('mailinPaymentWarning', $event)"></textarea>
				</div>
			</div>

			<h5 class="section-heading">Auto-Recurring Billing (ARB)</h5>
			<div class="form-grid">
				<div class="form-check-group">
					<label class="form-check">
						<input type="checkbox" class="form-check-input" [checked]="c.adnArb"
							(change)="updateCheckbox('adnArb', $event)">
						<span class="form-check-label">Enable ARB</span>
					</label>
				</div>
				@if (c.adnArb) {
					<div class="form-group">
						<label class="form-label">Billing Occurrences</label>
						<input type="number" class="form-control"
							[value]="c.adnArbbillingOccurences ?? ''"
							(input)="updateNumber('adnArbbillingOccurences', $event)">
					</div>
					<div class="form-group">
						<label class="form-label">Interval Length</label>
						<input type="number" class="form-control"
							[value]="c.adnArbintervalLength ?? ''"
							(input)="updateNumber('adnArbintervalLength', $event)">
					</div>
					<div class="form-group">
						<label class="form-label">Start Date</label>
						<input type="date" class="form-control"
							[value]="toDateInputValue(c.adnArbstartDate)"
							(input)="updateFieldFromEvent('adnArbstartDate', $event)">
					</div>
					<div class="form-group">
						<label class="form-label">Minimum Total Charge</label>
						<input type="number" step="0.01" class="form-control"
							[value]="c.adnArbMinimunTotalCharge ?? ''"
							(input)="updateNumber('adnArbMinimunTotalCharge', $event)">
					</div>
				}
			</div>
		</div>
	}

	<!-- ══════════════════════════════════════ -->
	<!-- TAB 4: Email & Templates              -->
	<!-- ══════════════════════════════════════ -->
	@if (activeTab() === 'email') {
		<div class="config-section">
			<h5 class="section-heading">Email Settings</h5>
			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">From Address</label>
					<input type="email" class="form-control" [value]="c.regFormFrom ?? ''"
						(input)="updateFieldFromEvent('regFormFrom', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">CC Addresses</label>
					<input type="text" class="form-control" [value]="c.regFormCcs ?? ''"
						(input)="updateFieldFromEvent('regFormCcs', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">BCC Addresses</label>
					<input type="text" class="form-control" [value]="c.regFormBccs ?? ''"
						(input)="updateFieldFromEvent('regFormBccs', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Reschedule Email List</label>
					<input type="text" class="form-control" [value]="c.rescheduleemaillist ?? ''"
						(input)="updateFieldFromEvent('rescheduleemaillist', $event)">
				</div>
				<div class="form-group">
					<label class="form-label">Always Copy Email List</label>
					<input type="text" class="form-control" [value]="c.alwayscopyemaillist ?? ''"
						(input)="updateFieldFromEvent('alwayscopyemaillist', $event)">
				</div>
				<div class="form-check-group">
					<label class="form-check">
						<input type="checkbox" class="form-check-input" [checked]="c.bDisallowCcplayerConfirmations"
							(change)="updateCheckbox('bDisallowCcplayerConfirmations', $event)">
						<span class="form-check-label">Disallow CC on Player Confirmations</span>
					</label>
				</div>
			</div>

			<h5 class="section-heading">Player Registration Templates</h5>
			<div class="form-grid">
				<div class="form-group span-2">
					<label class="form-label">Confirmation Email (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.playerRegConfirmationEmail ?? ''"
						(input)="updateFieldFromEvent('playerRegConfirmationEmail', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Confirmation On-Screen (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.playerRegConfirmationOnScreen ?? ''"
						(input)="updateFieldFromEvent('playerRegConfirmationOnScreen', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Refund Policy (HTML)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.playerRegRefundPolicy ?? ''"
						(input)="updateFieldFromEvent('playerRegRefundPolicy', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Release of Liability (HTML)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.playerRegReleaseOfLiability ?? ''"
						(input)="updateFieldFromEvent('playerRegReleaseOfLiability', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Code of Conduct (HTML)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.playerRegCodeOfConduct ?? ''"
						(input)="updateFieldFromEvent('playerRegCodeOfConduct', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">COVID-19 Waiver (HTML)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.playerRegCovid19Waiver ?? ''"
						(input)="updateFieldFromEvent('playerRegCovid19Waiver', $event)"></textarea>
				</div>
			</div>

			<h5 class="section-heading">Adult Registration Templates</h5>
			<div class="form-grid">
				<div class="form-group span-2">
					<label class="form-label">Confirmation Email (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.adultRegConfirmationEmail ?? ''"
						(input)="updateFieldFromEvent('adultRegConfirmationEmail', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Confirmation On-Screen (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.adultRegConfirmationOnScreen ?? ''"
						(input)="updateFieldFromEvent('adultRegConfirmationOnScreen', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Refund Policy (HTML)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.adultRegRefundPolicy ?? ''"
						(input)="updateFieldFromEvent('adultRegRefundPolicy', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Release of Liability (HTML)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.adultRegReleaseOfLiability ?? ''"
						(input)="updateFieldFromEvent('adultRegReleaseOfLiability', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Code of Conduct (HTML)</label>
					<textarea class="form-control font-monospace" rows="4"
						[value]="c.adultRegCodeOfConduct ?? ''"
						(input)="updateFieldFromEvent('adultRegCodeOfConduct', $event)"></textarea>
				</div>
			</div>

			<h5 class="section-heading">Referee Registration Templates</h5>
			<div class="form-grid">
				<div class="form-group span-2">
					<label class="form-label">Confirmation Email (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.refereeRegConfirmationEmail ?? ''"
						(input)="updateFieldFromEvent('refereeRegConfirmationEmail', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Confirmation On-Screen (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.refereeRegConfirmationOnScreen ?? ''"
						(input)="updateFieldFromEvent('refereeRegConfirmationOnScreen', $event)"></textarea>
				</div>
			</div>

			<h5 class="section-heading">Recruiter Registration Templates</h5>
			<div class="form-grid">
				<div class="form-group span-2">
					<label class="form-label">Confirmation Email (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.recruiterRegConfirmationEmail ?? ''"
						(input)="updateFieldFromEvent('recruiterRegConfirmationEmail', $event)"></textarea>
				</div>
				<div class="form-group span-2">
					<label class="form-label">Confirmation On-Screen (HTML)</label>
					<textarea class="form-control font-monospace" rows="5"
						[value]="c.recruiterRegConfirmationOnScreen ?? ''"
						(input)="updateFieldFromEvent('recruiterRegConfirmationOnScreen', $event)"></textarea>
				</div>
			</div>
		</div>
	}

	<!-- ══════════════════════════════════════ -->
	<!-- TAB 5: Features & Store               -->
	<!-- ══════════════════════════════════════ -->
	@if (activeTab() === 'features') {
		<div class="config-section">
			<h5 class="section-heading">Club Rep Permissions</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bClubRepAllowEdit"
						(change)="updateCheckbox('bClubRepAllowEdit', $event)">
					<span class="form-check-label">Allow Edit</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bClubRepAllowDelete"
						(change)="updateCheckbox('bClubRepAllowDelete', $event)">
					<span class="form-check-label">Allow Delete</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bClubRepAllowAdd"
						(change)="updateCheckbox('bClubRepAllowAdd', $event)">
					<span class="form-check-label">Allow Add</span>
				</label>
			</div>

			<h5 class="section-heading">Mobile Features</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bAllowMobileLogin"
						(change)="updateCheckbox('bAllowMobileLogin', $event)">
					<span class="form-check-label">Allow Mobile Login</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bEnableMobileRsvp"
						(change)="updateCheckbox('bEnableMobileRsvp', $event)">
					<span class="form-check-label">Enable Mobile RSVP</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bEnableMobileTeamChat"
						(change)="updateCheckbox('bEnableMobileTeamChat', $event)">
					<span class="form-check-label">Enable Mobile Team Chat</span>
				</label>
			</div>

			<h5 class="section-heading">Roster & Schedule</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bAllowRosterViewAdult"
						(change)="updateCheckbox('bAllowRosterViewAdult', $event)">
					<span class="form-check-label">Allow Roster View (Adult)</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bAllowRosterViewPlayer"
						(change)="updateCheckbox('bAllowRosterViewPlayer', $event)">
					<span class="form-check-label">Allow Roster View (Player)</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bShowTeamNameOnlyInSchedules"
						(change)="updateCheckbox('bShowTeamNameOnlyInSchedules', $event)">
					<span class="form-check-label">Show Team Name Only in Schedules</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bScheduleAllowPublicAccess"
						(change)="updateCheckbox('bScheduleAllowPublicAccess', $event)">
					<span class="form-check-label">Schedule Allow Public Access</span>
				</label>
			</div>

			<h5 class="section-heading">Platform Enables</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bTeamPushDirectors"
						(change)="updateCheckbox('bTeamPushDirectors', $event)">
					<span class="form-check-label">Team Push Directors</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bEnableTsicteams"
						(change)="updateCheckbox('bEnableTsicteams', $event)">
					<span class="form-check-label">Enable TSIC Teams</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.benableStp"
						(change)="updateCheckbox('benableStp', $event)">
					<span class="form-check-label">Enable STP</span>
				</label>
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bSignalRschedule"
						(change)="updateCheckbox('bSignalRschedule', $event)">
					<span class="form-check-label">SignalR Schedule</span>
				</label>
			</div>

			<div class="form-grid">
				<div class="form-group">
					<label class="form-label">Mobile Score Hours Past Game Eligible</label>
					<input type="number" class="form-control"
						[value]="c.mobileScoreHoursPastGameEligible ?? ''"
						(input)="updateNumber('mobileScoreHoursPastGameEligible', $event)">
				</div>
			</div>

			<h5 class="section-heading">Store</h5>
			<div class="form-check-group">
				<label class="form-check">
					<input type="checkbox" class="form-check-input" [checked]="c.bEnableStore"
						(change)="updateCheckbox('bEnableStore', $event)">
					<span class="form-check-label">Enable Store</span>
				</label>
			</div>
			@if (c.bEnableStore) {
				<div class="form-grid">
					<div class="form-group">
						<label class="form-label">Sales Tax</label>
						<input type="number" step="0.01" class="form-control"
							[value]="c.storeSalesTax"
							(input)="updateNumber('storeSalesTax', $event)">
					</div>
					<div class="form-group">
						<label class="form-label">TSIC Rate</label>
						<input type="number" step="0.01" class="form-control"
							[value]="c.storeTsicrate ?? ''"
							(input)="updateNumber('storeTsicrate', $event)">
					</div>
					<div class="form-group">
						<label class="form-label">Contact Email</label>
						<input type="email" class="form-control" [value]="c.storeContactEmail ?? ''"
							(input)="updateFieldFromEvent('storeContactEmail', $event)">
					</div>
					<div class="form-group span-2">
						<label class="form-label">Refund Policy</label>
						<textarea class="form-control" rows="3" [value]="c.storeRefundPolicy ?? ''"
							(input)="updateFieldFromEvent('storeRefundPolicy', $event)"></textarea>
					</div>
					<div class="form-group span-2">
						<label class="form-label">Pickup Details</label>
						<textarea class="form-control" rows="3" [value]="c.storePickupDetails ?? ''"
							(input)="updateFieldFromEvent('storePickupDetails', $event)"></textarea>
					</div>
				</div>
			}
		</div>
	}

	<!-- ══════════════════════════════════════ -->
	<!-- TAB 6: DDL Options (Placeholder)      -->
	<!-- ══════════════════════════════════════ -->
	@if (activeTab() === 'ddl') {
		<div class="config-section">
			<div class="text-center py-5 text-body-secondary">
				<i class="bi bi-list-ul" style="font-size: 3rem;"></i>
				<p class="mt-2">DDL Options editor will be integrated here in Phase 6.</p>
			</div>
		</div>
	}

	<!-- ══════════════════════════════════════ -->
	<!-- Sticky save bar                       -->
	<!-- ══════════════════════════════════════ -->
	@if (isDirty()) {
		<div class="save-bar">
			<span class="save-bar-text">
				<i class="bi bi-pencil-square me-1"></i>
				Unsaved changes
			</span>
			<div class="d-flex gap-2">
				<button class="btn btn-outline-secondary btn-sm" (click)="discard()" [disabled]="isSaving()">
					Discard
				</button>
				<button class="btn btn-primary btn-sm" (click)="save()" [disabled]="isSaving()">
					@if (isSaving()) {
						<span class="spinner-border spinner-border-sm me-1"></span>
						Saving...
					} @else {
						<i class="bi bi-check-lg me-1"></i>Save Changes
					}
				</button>
			</div>
		</div>
	}
}
