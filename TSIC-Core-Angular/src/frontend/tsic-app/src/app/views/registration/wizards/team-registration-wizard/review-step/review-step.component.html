<div class="review-step-container">
  @if (isLoading()) {
  <!-- Loading state -->
  <div class="d-flex align-items-center justify-content-center py-5">
    <div class="spinner-border me-2" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <span>Loading confirmation...</span>
  </div>
  } @else if (error()) {
  <!-- Error state -->
  <div class="alert alert-danger d-flex align-items-start" role="alert">
    <i class="bi bi-exclamation-triangle-fill me-2 mt-1 fs-5"></i>
    <div class="flex-grow-1">
      <strong>Unable to Load Confirmation</strong>
      <p class="mb-0 mt-1">{{ error() }}</p>
      <button class="btn btn-sm btn-outline-danger mt-2" (click)="loadConfirmationText()">
        <i class="bi bi-arrow-clockwise me-1"></i>Retry
      </button>
    </div>
  </div>
  } @else if (confirmationHtml()) {
  <!-- Confirmation display -->
  <div class="confirmation-wrapper">
    <!-- Resend and Print buttons at top -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="mb-0">Registration Confirmation</h5>
      <div class="d-flex gap-2">
        <button class="btn btn-sm btn-outline-secondary" (click)="printConfirmation()" [disabled]="!confirmationHtml()">
          <i class="bi bi-printer me-1"></i>Print
        </button>
        <button class="btn btn-sm btn-outline-primary" (click)="resendConfirmationEmail()"
          [disabled]="isResending() || !canResend()">
          @if (isResending()) {
          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          <span>Sending...</span>
          } @else {
          <i class="bi bi-envelope me-1"></i>Re-send Confirmation Email
          }
        </button>
      </div>
    </div>

    <!-- Confirmation content -->
    <div class="confirmation-content border rounded p-4 bg-light">
      <div [innerHTML]="confirmationHtml()"></div>
    </div>

    <!-- Info message -->
    <div class="alert alert-info mt-3" role="alert">
      <i class="bi bi-info-circle me-2"></i>
      <strong>Confirmation Sent</strong> - A confirmation email has been sent
      to your registered email address. Use the button above to resend if
      needed.
    </div>
  </div>
  }
</div>