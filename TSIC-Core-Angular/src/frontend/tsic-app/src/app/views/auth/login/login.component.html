<main aria-labelledby="login-title" [attr.aria-busy]="auth.loginLoading()">
  <div class="login-wrapper">
    <div class="card card-rounded login-card">
      <div class="login-header text-center border-0">
        <h2 id="login-title" class="mb-0 fw-bold">{{ headerText }}</h2>
        <p class="mb-0 mt-2 small">{{ subHeaderText }}</p>
      </div>

      <div class="card-body">
        <form [formGroup]="form" (ngSubmit)="onSubmit($event)" autocomplete="on" name="login" id="login-form"
          method="post" action="/" novalidate>

          <div class="login-field">
            <label for="username" class="form-label fw-semibold">Username</label>
            <input #usernameInput id="username" name="username" type="text" class="form-control form-control-lg"
              formControlName="username" placeholder="Enter your username" autocomplete="username" aria-label="Username"
              [class.is-invalid]="submitted() && form.get('username')?.invalid">
            @if (submitted() && form.get('username')?.invalid) {
            <div class="invalid-feedback">
              Username is required
            </div>
            }
          </div>

          <div class="login-field">
            <label for="password" class="form-label fw-semibold">Password</label>
            <div class="position-relative">
              <input #passwordInput id="password" name="password" [type]="showPassword() ? 'text' : 'password'"
                class="form-control form-control-lg pe-5" formControlName="password"
                placeholder="Enter your password" [attr.autocomplete]="'current-password'" autocapitalize="none"
                spellcheck="false" aria-label="Password"
                [class.is-invalid]="submitted() && form.get('password')?.invalid">
              <button type="button" class="btn btn-link password-toggle"
                (click)="toggleShowPassword()"
                [attr.aria-label]="showPassword() ? 'Hide password' : 'Show password'" tabindex="-1">
                <i class="bi" [class.bi-eye]="!showPassword()" [class.bi-eye-slash]="showPassword()"></i>
              </button>
            </div>
            @if (submitted() && form.get('password')?.invalid) {
            <div class="invalid-feedback d-block">
              Password is required
            </div>
            }
          </div>

          @if (auth.loginError()) {
          <div class="alert alert-danger border-0 shadow-sm mb-4" role="alert">
            {{ auth.loginError() }}
          </div>
          }

          <button type="submit" class="btn btn-lg w-100 fw-semibold btn-primary"
            [disabled]="auth.loginLoading()">
            @if (!auth.loginLoading()) {
            <span>Sign In</span>
            } @else {
            <span>
              <span class="spinner-border spinner-border-sm me-2"></span>
              Signing in...
            </span>
            }
          </button>

          @if (theme !== 'login') {
          <div class="text-center login-escape">
            <a [routerLink]="['/tsic/login']" [queryParams]="escapeQueryParams" class="small text-decoration-underline">
              Not your login type? Switch
            </a>
          </div>
          }
        </form>
      </div>
    </div>
  </div>
</main>
